cmake_minimum_required(VERSION 3.5)

project(copy_scripts)

if(WIN32)
  file(GLOB scripts_BAT "*.bat")
  file(GLOB scripts_VBS "*.vbs")
  file(GLOB scripts_PS1 "*.ps1")
  file(GLOB scripts_LIB "lib/*.vbs")
else(WIN32)
  file(GLOB scripts_SH "*.sh")
endif(WIN32)
file(GLOB_RECURSE scripts_PYT "python/*.py")
file(GLOB_RECURSE scripts_LUA "lua/*.lua")

set(script_ALL ${scripts_BAT} ${scripts_VBS} ${scripts_PS1} ${scripts_SH})
set(ALL_FILES)

foreach(file ${script_ALL})
  get_filename_component(filename ${file} NAME)
  # MESSAGE(STATUS " + ${filename} (${file})")
  copy_single_file_755(ALL_FILES ${filename} scripts)
endforeach(file ${script_ALL})

foreach(file ${scripts_LIB})
  get_filename_component(filename ${file} NAME)
  # MESSAGE(STATUS " + lib - ${filename}")
  copy_single_file(ALL_FILES lib/${filename} scripts/lib)
endforeach(file ${scripts_LIB})

foreach(file ${scripts_PYT})
  get_filename_component(filename ${file} NAME)
  get_filename_component(filepath ${file} PATH)
  file(RELATIVE_PATH relpath ${CMAKE_CURRENT_SOURCE_DIR} "${filepath}")
  string(REPLACE "/" "_" alias "${relpath}")
  string(REPLACE "." "_" alias "${alias}")
  # MESSAGE(STATUS " + python - ${filename} - ${relpath} - ${alias}")
  copy_single_file(ALL_FILES ${relpath}/${filename} scripts/${relpath})
endforeach(file ${scripts_PYT})

foreach(file ${scripts_LUA})
  get_filename_component(filename ${file} NAME)
  get_filename_component(filepath ${file} PATH)
  file(RELATIVE_PATH relpath ${CMAKE_CURRENT_SOURCE_DIR} "${filepath}")
  string(REPLACE "/" "_" alias "${relpath}")
  string(REPLACE "." "_" alias "${alias}")
  # MESSAGE(STATUS " + lua - ${filename} - ${relpath} - ${alias}")
  copy_single_file(ALL_FILES ${relpath}/${filename} scripts/${relpath})
endforeach(file ${scripts_LUA})

add_custom_target(copy_scripts ALL DEPENDS ${ALL_FILES})
set_target_properties(copy_scripts PROPERTIES FOLDER "files")
